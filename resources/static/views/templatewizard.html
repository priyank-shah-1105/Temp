<section id="page_template_wizard">
    <error-display errors="templateWizardController.errors"
                   on-click="$root.ASM.RemoveError(error, templateWizardController.errors)"></error-display>
    <div class="alert alert-success" ng-if="templateWizardController.steps.step1.uploadEmc.showSuccess">
        <strong>{{'GENERIC_Success'|translate}}:</strong>
        <span translate="TEMPLATES_CREATE_TEMPLATE_WIZARD_successMessage"
              translate-values="{fileName:templateWizardController.fileModel.name}"></span>
        <button type="button"
                class="close"
                style="color:white;"
                data-dismiss="alert"
                aria-label="Close"
                ng-click="templateWizardController.steps.step1.uploadEmc.showSuccess = false">
            <span aria-hidden="true">×</span>
        </button>
    </div>

    <wizard on-finish="templateWizardController.finishWizard()"
            on-cancel="templateWizardController.cancel()"
            finish-button-text="templateWizardController.wizardFinishText">
        <!-- Create Template (Step1) -->
        <wizard-step step-title="{{'TEMPLATES_CREATE_TEMPLATE_WIZARD_CreateTemplate'|translate}}"
                     ng-if="!templateWizardController.steps.step1.hidden"
                     on-enter="templateWizardController.initStep1()"
                     on-next="templateWizardController.steps.step1.validate()">
            <p>
                {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_Step1Description'|translate}}
            </p>
            <div class="panel-group"
                 id="parent"
                 role="tablist"
                 aria-multiselectable="true">
                <!-- uploadEmc -->
                <!--<div class="panel panel-default">
                    <div class="panel-heading"
                         role="tab"
                         id="headId">
                        <h4 class="panel-title">
                            <span role="button"
                                  data-toggle="collapse"
                                  data-parent="#parent"
                                  data-target="#{{templateWizardController.steps.step1.uploadEmc.id}}"
                                  aria-expanded="{{:: templateWizardController.templateInputType === 'uploadEmc'}}"
                                  ng-class=":: templateWizardController.templateInputType === 'uploadEmc' ?  'in' :'collapsed'"
                                  aria-controls="{{templateWizardController.steps.step1.uploadEmc.id}}">
                                <span class="radio">
                                    <label>
                                        <input type="radio"
                                               ng-model="templateWizardController.templateInputType"
                                               value="uploadEmc">
                                        {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_UploadEMCTemplateRadio'| translate}}
                                    </label>
                                </span>
                            </span>
                        </h4>
                    </div>
                    <div id="{{templateWizardController.steps.step1.uploadEmc.id}}"
                         class="panel-collapse collapse"
                         ng-class=":: templateWizardController.templateInputType === 'uploadEmc' ?  'in' :'collapsed'"
                         role="tabpanel"
                         aria-labelledby="headId">
                        <div class="panel-body well">
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-6">
                                        <form name="templateWizardController.steps.step1.uploadEmc.form"
                                              class="form-horizontal"
                                              id="step1EmcUploadForm"
                                              form-validation="templateWizardController.steps.step1.uploadEmc.form._submitted"
                                              method="post"
                                              enctype="multipart/form-data">
                                            <div class="form-group">
                                                <strong class="col-xs-12">
                                                    {{'TEMPLATES_UploadExternalModal_UploadEMCInstructions'|translate}}
                                                </strong>
                                            </div>
                                            <div class="form-group">
                                                <label for="emcTemplatefile" class="col-md-4 control-label">
                                                    {{'TEMPLATES_UploadExternalModal_SelectTemplate' | translate}}
                                                </label>
                                                <div class="col-md-8">
                                                    <div id="fileWrapper">
                                                        <input ng-required="templateWizardController.templateInputType === 'uploadEmc'"
                                                               uploader="uploader"
                                                               nv-file-select
                                                               ng-model="templateWizardController.steps.step1.uploadEmc.fileModel"
                                                               id="emcTemplatefile"
                                                               type="file"
                                                               text="Browse"
                                                               name="emcTemplatefile" />
                                                    </div>
                                                    <div class="text-danger" ng-if="templateWizardController.steps.step1.uploadEmc.form._submitted">
                                                        <div ng-if="templateWizardController.steps.step1.uploadEmc.form.emcTemplatefile.$error.required">
                                                            {{'GENERIC_RequiredField'|translate}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-4 control-label">
                                                    {{'TEMPLATES_UploadExternalModal_EncryptionPassword' | translate}}*
                                                </label>
                                                <div class="col-sm-4">
                                                    <div class="">
                                                        <div class="input-group">
                                                            <input id="encryptionPasswordEmc"
                                                                   name="encryptionPasswordEmc"
                                                                   ng-model="templateWizardController.steps.step1.uploadEmc.encryptionPassword"
                                                                   required
                                                                   class="form-control"
                                                                   type="password"
                                                                   placeholder="" password-viewer />
                                                        </div>
                                                    </div>
                                                    <div class="text-danger" ng-if="templateWizardController.steps.step1.uploadEmc.form._submitted">
                                                        <div ng-if="templateWizardController.steps.step1.uploadEmc.form.encryptionPasswordEmc.$error.required">
                                                            {{'GENERIC_RequiredField'|translate}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="col-xs-12">
                                            <blue-box-info></blue-box-info>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>-->
                <!-- clone -->
                <div class="panel panel-default">
                    <div class="panel-heading"
                         role="tab"
                         id="headId">
                        <h4 class="panel-title">
                            <span role="button"
                                  data-toggle="collapse"
                                  data-parent="#parent"
                                  data-target="#{{templateWizardController.steps.step1.clone.id}}"
                                  aria-expanded="{{:: templateWizardController.templateInputType === 'clone'}}"
                                  ng-class=":: templateWizardController.templateInputType === 'clone' ?  'in' :'collapsed'"
                                  aria-controls="{{templateWizardController.steps.step1.clone.id}}">
                                <span class="radio">
                                    <label>
                                        <input type="radio" ng-model="templateWizardController.templateInputType" value="clone">
                                        {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_CloneTemplateRadio'|translate}}
                                    </label>
                                </span>
                            </span>
                        </h4>
                    </div>
                    <div id="{{templateWizardController.steps.step1.clone.id}}"
                         class="panel-collapse collapse"
                         ng-class=":: templateWizardController.templateInputType === 'clone' ?  'in' : 'collapsed'"
                         role="tabpanel"
                         aria-labelledby="headId">
                        <div class="panel-body well">
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-6">
                                        <form name="templateWizardController.steps.step1.clone.form"
                                              class="form-horizontal"
                                              form-validation="templateWizardController.steps.step1.clone.form._submitted">
                                            <div class="form-group">
                                                <strong class="col-xs-12">
                                                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_CloneTemplate_InstructionText'|translate}}
                                                </strong>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-4 control-label" for="templatecategory">
                                                    {{'GENERIC_Category' | translate}}*
                                                </label>
                                                <div class="col-sm-8">
                                                    <select id="templatecategory"
                                                            class="form-control"
                                                            name="category"
                                                            ng-model="templateWizardController.steps.step1.clone.categoryOption"
                                                            ng-options="category.id as category.name for category in templateWizardController.steps.step1.clone.categories"
                                                            ng-required="templateWizardController.templateInputType === 'clone'">
                                                        <option value="">{{'GENERIC_select'|translate}}</option>
                                                    </select>
                                                    <div ng-if="templateWizardController.steps.step1.clone.form._submitted" class="text-danger">
                                                        <div ng-if="templateWizardController.steps.step1.clone.form.category.$error.required">
                                                            {{'GENERIC_RequiredField' | translate}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-4 control-label" for="templateToBeCloned">
                                                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_Clone_TemplateToBeCloned' | translate}}*
                                                </label>
                                                <div class="col-sm-8">
                                                    <select id="templateToBeCloned"
                                                            class="form-control"
                                                            name="templateToBeCloned"
                                                            ng-disabled="!templateWizardController.steps.step1.clone.categoryOption"
                                                            ng-model="templateWizardController.steps.step1.clone.selectedTemplate"
                                                            ng-options="template as template.name for template in templateWizardController.steps.step1.clone.templates | filter:{category:templateWizardController.steps.step1.clone.categoryOption}"
                                                            ng-required="templateWizardController.templateInputType === 'clone'">
                                                        <option value="">{{'GENERIC_select'|translate}}</option>
                                                    </select>
                                                    <div ng-if="templateWizardController.steps.step1.clone.form._submitted" class="text-danger">
                                                        <div ng-if="templateWizardController.steps.step1.clone.form.templateToBeCloned.$error.required">
                                                            {{'GENERIC_RequiredField' | translate}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="col-xs-12">
                                            <blue-box-info></blue-box-info>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- upload -->
                <div class="panel panel-default">
                    <div class="panel-heading"
                         role="tab"
                         id="headId">
                        <h4 class="panel-title">
                            <span role="button"
                                  data-toggle="collapse"
                                  data-parent="#parent"
                                  data-target="#{{templateWizardController.steps.step1.upload.id}}"
                                  aria-expanded="{{:: templateWizardController.templateInputType === 'upload'}}"
                                  ng-class=":: templateWizardController.templateInputType === 'upload' ?  'in' :'collapsed'"
                                  aria-controls="{{templateWizardController.steps.step1.upload.id}}">
                                <span class="radio">
                                    <label>
                                        <input type="radio"
                                               ng-model="templateWizardController.templateInputType"
                                               value="upload">
                                        {{'TEMPLATES_UploadExternalTemplate'|translate}}
                                    </label>
                                </span>
                            </span>
                        </h4>
                    </div>
                    <div id="{{templateWizardController.steps.step1.upload.id}}"
                         class="panel-collapse collapse"
                         ng-class=":: templateWizardController.templateInputType === 'upload' ?  'in' :'collapsed'"
                         role="tabpanel"
                         aria-labelledby="headId">
                        <!--<div class="panel-body well">

                            <form name="templateWizardController.steps.step1.upload.form"
                                  class="form-horizontal"
                                  form-validation="templateWizardController.steps.step1.upload.form._submitted">
                                <div class="form-group">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <div class="col-xs-12">
                                                    <label for="templatefile" class="col-md-4 control-label">
                                                        {{'TEMPLATES_UploadExternalModal_SelectTemplate' | translate}}
                                                    </label>
                                                    <div class="col-md-8">
                                                        <div id="fileWrapper2">
                                                            <input ng-required="templateWizardController.templateInputType === 'upload'"
                                                                   uploader="uploader2"
                                                                   nv-file-select
                                                                   ng-model="templateWizardController.steps.step1.upload.fileModel"
                                                                   id="templatefile"
                                                                   type="file"
                                                                   text="Browse"
                                                                   name="templatefile" />
                                                        </div>
                                                        <div class="text-danger" ng-if="templateWizardController.steps.step1.upload.form._submitted">
                                                            <div ng-if="templateWizardController.steps.step1.upload.form.templatefile.$error.required">
                                                                {{'GENERIC_RequiredField'|translate}}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="col-xs-12">
                                                    <label class="col-sm-4 control-label" for="useEncryption">
                                                        {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_Clone_EncryptionPassword'|translate}}
                                                    </label>
                                                    <div class="col-sm-8">
                                                        <div class="checkbox">
                                                            <label>
                                                                <input type="checkbox"
                                                                       ng-model="templateWizardController.steps.step1.upload.useEncPwdFromBackup"
                                                                       name="useEncryption"
                                                                       id="useEncryption" />
                                                                {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_Clone_UseEncryption'|translate}}
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="col-xs-12">
                                                <blue-box-info></blue-box-info>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>-->
                    </div>
                </div>
                <!-- create -->
                <div class="panel panel-default">
                    <div class="panel-heading"
                         role="tab"
                         id="headId">
                        <h4 class="panel-title">
                            <span role="button"
                                  data-toggle="collapse"
                                  data-parent="#parent"
                                  data-target="#{{templateWizardController.steps.step1.create.id}}"
                                  aria-expanded="{{:: templateWizardController.templateInputType === 'create'}}"
                                  ng-class=":: templateWizardController.templateInputType === 'create' ?  'in' :'collapsed'"
                                  aria-controls="{{templateWizardController.steps.step1.create.id}}">
                                <span class="radio">
                                    <label>
                                        <input type="radio" ng-model="templateWizardController.templateInputType" value="create">
                                        {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_CreateNewTemplateRadio'|translate}}
                                    </label>
                                </span>
                            </span>
                        </h4>
                    </div>
                    <div id="{{templateWizardController.steps.step1.create.id}}"
                         class="panel-collapse collapse"
                         ng-class=":: templateWizardController.templateInputType === 'create' ?  'in' :'collapsed'"
                         role="tabpanel"
                         aria-labelledby="headId">
                        <div class="panel-body well">
                            <div class="form-group">
                                <div class="row">
                                    <strong class="col-xs-12">
                                        {{'TEMPLATES_EDIT_TEMPLATE_WIZARD_CreateTemplate_Directions' | translate}}
                                    </strong>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="row">
                                    <div class="col-md-6">
                                        <form name="templateWizardController.steps.step1.create.form"
                                              class="form-horizontal"
                                              form-validation="templateWizardController.steps.step1.create.form._submitted">
                                            <div class="form-group">
                                                <label class="col-sm-4 control-label" for="templateName">
                                                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_Create_TemplateName' | translate}}*
                                                </label>
                                                <div class="col-sm-8">
                                                    <input class="form-control"
                                                           type="text"
                                                           maxlength="32"
                                                           ng-model="templateWizardController.template.name"
                                                           id="templateName"
                                                           name="templateName"
                                                           ng-required="templateWizardController.templateInputType === 'create'" />
                                                    <div ng-if="templateWizardController.steps.step1.create.form._submitted" class="text-danger">
                                                        <div ng-if="templateWizardController.steps.step1.create.form.templateName.$error.required">
                                                            {{'GENERIC_RequiredField' | translate}}
                                                        </div>
                                                    </div>

                                                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_Create_1to32Chars' | translate}}

                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="col-xs-12">
                                            <blue-box-info></blue-box-info>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </wizard-step>

        <!-- Upload EMC Validated System (step2B) -->
        <wizard-step step-title="{{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_Title'|translate}}"
                     extra-button="templateWizardController.saveAsDraftButton"
                     ng-if="templateWizardController.templateInputType === 'uploadEmc'"
                     on-next="templateWizardController.steps.step2B.save()"
                     on-enter="templateWizardController.steps.step2B.initialize()">
            <form name="templateWizardController.steps.step2B.form"
                  class="form-horizontal"
                  id="{{templateWizardController.steps.step2B.tagId}}"
                  role="form"
                  ng-if="templateWizardController.template.configureTemplateConfiguration"
                  novalidate
                  form-validation="templateWizardController.steps.step2B.form._submitted">
                <div class="form-group">
                    <div class="col-xs-12">
                        <strong>
                            {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_Directions'|translate}}
                        </strong>
                    </div>
                </div>
                <!-- Template Information -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_TemplateInformation' | translate}}
                </h4>
                <div class="well">
                    <template-information template="templateWizardController.template"
                                          errors="templateWizardController.errors"
                                          form="templateWizardController.steps.step2B.form"
                                          read-only="false"
                                          template-uploaded-name="{{templateWizardController.fileModel.name}}"
                                          templates="templateWizardController.steps.step1.clone.templates"
                                          ng-if="templateWizardController.steps.step1.clone.templates.length"></template-information>
                </div>
                <!-- Server Details -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_ServerDetails' | translate}}
                </h4>
                <div class="well">
                    <server-settings errors="templateWizardController.errors"
                                     form="templateWizardController.steps.step2B.form"
                                     server-settings="templateWizardController.template.configureTemplateConfiguration.serverSettings"
                                     read-only="false"></server-settings>

                </div>

                <!-- Cluster Details -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_ClusterDetails' | translate}}
                </h4>
                <div class="well">
                    <div ng-repeat="setting in templateWizardController.template.configureTemplateConfiguration.clusterDetailsSettings"
                         ng-if="templateWizardController.settingVisible(setting, templateWizardController.template.configureTemplateConfiguration.clusterDetailsSettings)"
                         class="form-group">
                        <basic-setting setting="setting"
                                       read-only-mode="false"
                                       filter-overwrite="templateWizardController.filteredoptions({setting: setting, settingsArray: templateWizardController.template.configureTemplateConfiguration.clusterDetailsSettings})"></basic-setting>
                    </div>
                </div>
                <p>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_Fieldisrequired'|translate}}
                </p>
            </form>
        </wizard-step>
        <!-- Define Network Settings (step2C) -->
        <wizard-step step-title="{{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2c_DefineNetworkSettings'|translate}}"
                     extra-button="templateWizardController.saveAsDraftButton"
                     ng-if="templateWizardController.templateInputType === 'uploadEmc'"
                     on-next="templateWizardController.steps.step2C.save()"
                     on-enter="templateWizardController.steps.step2C.initialize()">
            <form name="templateWizardController.steps.step2C.form"
                  class="form-horizontal"
                  id="{{templateWizardController.steps.step2C.tagId}}"
                  role="form"
                  ng-if="templateWizardController.template.configureTemplateConfiguration"
                  novalidate
                  form-validation="templateWizardController.steps.step2C.form._submitted">
                <div class="form-group">
                    <div class="col-xs-12">
                        <strong>
                            {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2c_Directions'|translate}}
                        </strong>
                    </div>
                </div>
                <div class="form-group" ng-repeat="networkSetting in templateWizardController.template.configureTemplateConfiguration.networkSettings">
                    <div class="col-xs-12">
                        <h4>
                            {{networkSetting.name}}
                            <a ng-if="$first"
                               ng-click="templateWizardController.viewNetworks()"
                               class="pull-right">
                                {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2c_ViewCreateNetworks' | translate}}
                            </a>
                        </h4>
                        <div class="well">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="setting{{$index}}type">
                                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2c_NetworkType' | translate}}
                                </label>
                                <div class="col-sm-8" id="setting{{$index}}type">
                                    {{networkSetting.type}}
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="networkType{{$index}}">
                                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2c_WhichASMNetwork' | translate}} *
                                </label>
                                <div class="col-sm-4">
                                    <select class="form-control"
                                            name="networkType{{$index}}"
                                            id="networkType{{$index}}"
                                            required
                                            ng-model="networkSetting.value"
                                            ng-options="option.id as option.name disable when option.disabled for option in templateWizardController.steps.step2C.networks | networkVisible:networkSetting.network">
                                        <option value="">
                                            {{ 'GENERIC_select' | translate }}
                                        </option>
                                    </select>
                                    <div ng-if="templateWizardController.steps.step2C.form._submitted" class="text-danger">
                                        <div ng-if="templateWizardController.steps.step2C.form['networkType' + $index].$error.required">
                                            {{'GENERIC_RequiredField' | translate }}
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </form>
            <p>
                {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_Fieldisrequired'|translate}}
            </p>
        </wizard-step>

        <!-- Virtual Distributed Switch (VDS) Settings (step3A) -->
        <wizard-step step-title="{{'TEMPLATES_CREATE_TEMPLATE_WIZARD_3a_VirtualDistributedSwitchVDSDetails'|translate}}"
                     extra-button="templateWizardController.saveAsDraftButton"
                     ng-if="templateWizardController.templateInputType === 'uploadEmc'"
                     on-next="templateWizardController.steps.step3A.save()"
                     on-enter="templateWizardController.steps.step3A.initialize()">
            <p>
                {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_3a_Description'|translate}}
            </p>
            <form name="templateWizardController.steps.step3A.form"
                  class="form-horizontal"
                  role="form"
                  id="{{templateWizardController.steps.step3A.tagId}}"
                  ng-if="templateWizardController.template.configureTemplateConfiguration"
                  novalidate
                  form-validation="templateWizardController.steps.step3A.form._submitted">
                <div class="well">
                    <div ng-repeat="group in templateWizardController.template.configureTemplateConfiguration.vdsSettings | vdsTemplateSettingsFilter | groupFilter" class="row">
                        <!-- no group, individual setting -->
                        <div ng-if="!group.group">
                            <div ng-repeat="setting in templateWizardController.template.configureTemplateConfiguration.vdsSettings | vdsTemplateSettingsFilter"
                                 ng-if="setting.group === group.group"
                                 class="form-group">
                                <basic-setting setting="setting"
                                               read-only-mode="false"
                                               filter-overwrite="templateWizardController.filteredoptions({setting: setting, settingsArray: templateWizardController.template.configureTemplateConfiguration.vdsSettings})"
                                               form="templateWizardController.steps.step3A.form"></basic-setting>
                            </div>
                        </div>
                        <!-- Groups -->
                        <div ng-if="group.group">
                            <div class="panel-heading"
                                 role="tab"
                                 ng-if="group.group"
                                 id="headId{{$index}}_parent_{{$parent.$index}}"
                                 style="border-bottom: none;">
                                <a tabindex="0"
                                   style="outline: none;"
                                   role="button"
                                   data-toggle="collapse"
                                   data-target="#target{{$index}}_parent_{{$parent.$index}}"
                                   aria-expanded="{{:: $first}}"
                                   ng-class=":: $first ?  'in' :'collapsed'"
                                   aria-controls="device{{$index}}">
                                    <ul class="list-inline" style="margin-bottom: 0;">
                                        <li style="color: #888; vertical-align: top;">
                                            <i class="collapsed-show ci-arrow-chev-right-2-med ci"></i>
                                            <i class="collapsed-hide ci-arrow-chev-down-2-med ci"></i>
                                        </li>
                                        <li>
                                            <h4 style="margin-top: 0; margin-bottom: 10px; border-bottom: none;">
                                                {{group.group}}
                                            </h4>
                                        </li>
                                    </ul>
                                </a>
                                <div class="col-xs-12 panel-collapse collapse"
                                     ng-class="::{' in' : $first}"
                                     id="target{{$index}}_parent_{{$parent.$index}}"
                                     aria-labelledby="headId{{$index}}_parent_{{$parent.$index}}"
                                     role="tabpanel">

                                    <div ng-repeat="setting in templateWizardController.template.configureTemplateConfiguration.vdsSettings | vdsTemplateSettingsFilter"
                                         ng-if="setting.group === group.group"
                                         class="form-group">
                                        <basic-setting setting="setting"
                                                       read-only-mode="false"
                                                       filter-overwrite="templateWizardController.filteredoptions({setting: setting, settingsArray: templateWizardController.template.configureTemplateConfiguration.vdsSettings})"
                                                       form="templateWizardController.steps.step3A.form"></basic-setting>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </form>
        </wizard-step>

        <!-- Define Storage Settings (step4A) -->
        <wizard-step step-title="{{'TEMPLATES_CREATE_TEMPLATE_WIZARD_4a_DefineStorageSettings'|translate}}"
                     extra-button="templateWizardController.saveAsDraftButton"
                     ng-if="templateWizardController.templateInputType === 'uploadEmc' && templateWizardController.template.configureTemplateConfiguration.storageSettings.length"
                     on-next="templateWizardController.steps.step4A.save()"
                     on-enter="templateWizardController.steps.step4A.initialize()">
            <p>
                {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_4a_description'|translate}}
            </p>
            <form name="templateWizardController.steps.step4A.form"
                  class="form-horizontal"
                  role="form"
                  id="{{templateWizardController.steps.step4A.tagId}}"
                  ng-if="templateWizardController.template.configureTemplateConfiguration"
                  novalidate
                  form-validation="templateWizardController.steps.step4A.form._submitted">
                <storage-settings storage-settings="templateWizardController.template.configureTemplateConfiguration.storageSettings"
                                  form="templateWizardController.steps.step4A.form"
                                  errors="templateWizardController.errors"
                                  read-only="false"></storage-settings>
            </form>
            <div class="row">
                <div class="col-xs-12">
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_Fieldisrequired'|translate}}
                </div>
            </div>
        </wizard-step>

        <!-- Template Summary (summary) -->
        <wizard-step step-title="{{'TEMPLATES_CREATE_TEMPLATE_WIZARD_Summary_Title'|translate}}"
                     extra-button="templateWizardController.saveAsDraftButton"
                     ng-if="templateWizardController.template.configureTemplateConfiguration"
                     on-enter="templateWizardController.steps.summary.initialize()">
            <form class="form-horizontal">
                <div class="form-group">
                    <div class="col-xs-12">
                        <p ng-bind-html="'TEMPLATES_CREATE_TEMPLATE_WIZARD_Summary_Directions'|translate|htmlSafe"></p>
                    </div>
                </div>
                <!-- Template Information -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_TemplateInformation' | translate}}
                </h4>
                <div class="well">
                    <template-information template="templateWizardController.template"
                                          errors="templateWizardController.errors"
                                          form="templateWizardController.steps.step2B.form"
                                          read-only="true"
                                          templates="templateWizardController.steps.step1.clone.templates"
                                          ng-if="templateWizardController.steps.step1.clone.templates.length"></template-information>
                </div>
                <!-- Server Details -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_ServerDetails' | translate}}
                </h4>
                <div class="well">
                    <server-settings errors="templateWizardController.errors"
                                     form="templateWizardController.steps.step2B.form"
                                     server-settings="templateWizardController.template.configureTemplateConfiguration.serverSettings"
                                     read-only="true"></server-settings>
                </div>
                <!-- Cluster Details -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2b_ClusterDetails' | translate}}
                </h4>
                <div class="well">
                    <div ng-repeat="setting in templateWizardController.template.configureTemplateConfiguration.clusterDetailsSettings"
                         ng-if="templateWizardController.settingVisible(setting, templateWizardController.template.configureTemplateConfiguration.clusterDetailsSettings)"
                         class="form-group">
                        <basic-setting setting="setting"
                                       read-only-mode="true"
                                       filter-overwrite="templateWizardController.filteredoptions({setting: setting, settingsArray: templateWizardController.template.configureTemplateConfiguration.clusterDetailsSettings})"></basic-setting>
                    </div>
                </div>
                <!-- Network Settings -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_2c_NetworkSettings'|translate}}
                </h4>
                <div class="well" ng-if="templateWizardController.template.configureTemplateConfiguration">
                    <table class="table"
                           ng-if="templateWizardController.steps.summary.safeNetworkTableData"
                           st-safe-src="templateWizardController.steps.summary.safeNetworkTableData"
                           st-table="templateWizardController.template.configureTemplateConfiguration.networkSettings">
                        <thead>
                            <tr>
                                <th st-sort="name">
                                    {{"TEMPLATES_CREATE_TEMPLATE_WIZARD_Summary_NetworkDefinitioninUploadedTemplate" | translate}}
                                </th>
                                <th st-sort="type">
                                    {{"TEMPLATES_CREATE_TEMPLATE_WIZARD_Summary_NetworkType" | translate}}
                                </th>
                                <th st-sort="network">
                                    {{"TEMPLATES_CREATE_TEMPLATE_WIZARD_Summary_ASMNetworktobeUsedforthisNetworkType" | translate}}
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="networkSetting in templateWizardController.template.configureTemplateConfiguration.networkSettings">
                                <td>
                                    {{networkSetting.name}}
                                </td>
                                <td>
                                    {{networkSetting.type}}
                                </td>
                                <td>
                                    <list-lookup list="templateWizardController.steps.step2C.networks"
                                                 key="networkSetting.value"
                                                 ng-if="networkSetting.value"
                                                 property-name="'name'"></list-lookup>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Virtual Distributed Switch (VDS) Settings -->
                <h4>
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_3a_VirtualDistributedSwitchVDSSettings'|translate}}
                </h4>
                <div class="well">
                    <div ng-repeat="group in templateWizardController.template.configureTemplateConfiguration.vdsSettings | vdsTemplateSettingsFilter | groupFilter" class="row">
                        <!-- no group, individual setting -->
                        <div ng-if="!group.group">
                            <div ng-repeat="setting in templateWizardController.template.configureTemplateConfiguration.vdsSettings | vdsTemplateSettingsFilter"
                                 ng-if="setting.group === group.group"
                                 class="form-group">
                                <basic-setting setting="setting"
                                               read-only-mode="true"
                                               filter-overwrite="templateWizardController.filteredoptions({setting: setting, settingsArray: templateWizardController.template.configureTemplateConfiguration.vdsSettings})"></basic-setting>
                            </div>
                        </div>
                        <!-- Groups -->
                        <div ng-if="group.group">
                            <div class="panel-heading"
                                 role="tab"
                                 ng-if="group.group"
                                 id="headId{{$index}}_parent_{{$parent.$index}}_viewSummary"
                                 style="border-bottom: none;">
                                <a tabindex="0"
                                   style="outline: none;"
                                   role="button"
                                   data-toggle="collapse"
                                   data-target="#target{{$index}}_parent_{{$parent.$index}}_viewSummary"
                                   aria-expanded="{{:: $first}}"
                                   ng-class=":: $first ?  'in' :'collapsed'"
                                   aria-controls="device{{$index}}_viewSummary">
                                    <ul class="list-inline" style="margin-bottom: 0;">
                                        <li style="color: #888; vertical-align: top;">
                                            <i class="collapsed-show ci-arrow-chev-right-2-med ci"></i>
                                            <i class="collapsed-hide ci-arrow-chev-down-2-med ci"></i>
                                        </li>
                                        <li>
                                            <h4 style="margin-top: 0; margin-bottom: 10px; border-bottom: none;">
                                                {{group.group}}
                                            </h4>
                                        </li>
                                    </ul>
                                </a>
                                <div class="col-xs-12 panel-collapse collapse"
                                     ng-class="::{' in' : $first}"
                                     id="target{{$index}}_parent_{{$parent.$index}}_viewSummary"
                                     aria-labelledby="headId{{$index}}_parent_{{$parent.$index}}_viewSummary"
                                     role="tabpanel">

                                    <div ng-repeat="setting in templateWizardController.template.configureTemplateConfiguration.vdsSettings | vdsTemplateSettingsFilter"
                                         ng-if="setting.group === group.group"
                                         class="form-group">
                                        <basic-setting setting="setting"
                                                       read-only-mode="true"
                                                       filter-overwrite="templateWizardController.filteredoptions({setting: setting, settingsArray: templateWizardController.template.configureTemplateConfiguration.vdsSettings})"></basic-setting>
                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <!-- Storage Settings -->
                <h4 ng-if="templateWizardController.template.configureTemplateConfiguration.storageSettings.length">
                    {{'TEMPLATES_CREATE_TEMPLATE_WIZARD_4a_StorageSettings'|translate}}
                </h4>
                <div ng-if="templateWizardController.template.configureTemplateConfiguration.storageSettings.length">
                    <storage-settings storage-settings="templateWizardController.template.configureTemplateConfiguration.storageSettings"
                                      errors="templateWizardController.errors"
                                      read-only="true"></storage-settings>
                </div>
            </form>

        </wizard-step>

        <!-- Fake step to allow next button to be pressed -->
        <wizard-step step-title="" ng-if="templateWizardController.templateInputType === 'clone' || templateWizardController.templateInputType === 'upload' || templateWizardController.templateInputType === 'create'"></wizard-step>

    </wizard>
</section>